sudo: false
language: cpp

git:
  submodules: false

compiler:
  - gcc
  - clang

install:
  - export COMPILER_NAME=$CXX
  - if [ "$CXX" = "g++" ]; then export CXX=g++-5 CC=gcc-5; fi
  - if [ "$CXX" = "clang++" ]; then export CXX=clang++-3.7 CC=clang-3.7; fi

before_deploy:
  - make pack-release

deploy:
  provider: releases
  api-key:
    secure: T40df2pQsgo3oAmQxVqrz28g0nXVeTLlTnk7p5jrIwxcX8myRGe4C6OuE7qzECl7BAS6zRr/t8Gv7ytZQyZ0occHZctfybV7m+PXISavTpjwtVqjjYo0N9DT1lD3p5awDqnaPfRt657J0nvSp1gXThgdC5l1zrrnRK/L0HY43co=
  file: "release/release_$TRAVIS_OS_NAME_$COMPILER_NAME.tbz2"
  skip_cleanup: true
  on:
    tags: true

script:
  - make clean git && make all test

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
      - llvm-toolchain-precise
    packages:
      - gcc-5
      - g++-5
      - clang-3.7
