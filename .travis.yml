sudo: false
language: cpp

git:
  submodules: false

compiler:
  - gcc
  - clang

install:
  - export COMPILER_NAME=$CXX
  - if [ "$CXX" = "g++" ]; then export CXX=g++-5 CC=gcc-5; fi
  - if [ "$CXX" = "clang++" ]; then export CXX=clang++-3.7 CC=clang-3.7; fi

before_deploy:
  - make pack-release

deploy:
  provider: releases
  api-key:
    secure: Kcl45kpp9AonX2u8o5DDkKZklG9Guv6LBEhgCKncycSySwCz82QiBgzBaZCZfuVbFQVcmZGTdwJVRxGdOq2Upi8vdHKnTzzLGtdx/rk2wxUXIfBP33PdejpdV5A+6tR4+vrC+/Rys6clkNHWBwgou3gmcHAo+bEsYC5A7poH0M4=
  file: "release/release_$TRAVIS_OS_NAME_$COMPILER_NAME.tbz2"
  skip_cleanup: true
  on:
    tags: true

script:
  - make clean git && make all test

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
      - llvm-toolchain-precise
    packages:
      - gcc-5
      - g++-5
      - clang-3.7
